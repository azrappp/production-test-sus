import{A as S,r as C,e as I,a as x,u as O,j as e,L as E}from"./index-BmSsj0-w.js";import{H as L,a as D}from"./index-CAa21jnc.js";import{d as $}from"./useAuthUser-Ca2iW8uB.js";import{a as T,b as _}from"./config-CbMpPa7o.js";import{Q as A,B as w}from"./react-toastify.esm-gax5al5G.js";import"./iconBase-B-ZdwKJU.js";var m={};Object.defineProperty(m,"__esModule",{value:!0});var j=m.default=void 0,B=S,y=C,b=I;function F(){var r=(0,B.useReactAuthKit)();return function(t){if(r.value.isUsingRefreshToken){if(t.refresh)return r.set((0,y.doSignIn)(t)),!0;throw new b.AuthError("This appication is using refresh token feature. So please include `refresh` param in the parameters")}else{if(t.refresh)throw new b.AuthError("This appication is not using refresh token feature. So please remove the `refresh` param in the parameters. In Case you want to use refresh token feature, make sure you added that while creating the store.");return r.set((0,y.doSignIn)(t)),!0}}}j=m.default=F;class i extends Error{}i.prototype.name="InvalidTokenError";function H(r){return decodeURIComponent(atob(r).replace(/(.)/g,(t,a)=>{let s=a.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}function U(r){let t=r.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return H(t)}catch{return atob(t)}}function v(r,t){if(typeof r!="string")throw new i("Invalid token specified: must be a string");t||(t={});const a=t.header===!0?0:1,s=r.split(".")[a];if(typeof s!="string")throw new i(`Invalid token specified: missing part #${a+1}`);let l;try{l=U(s)}catch(n){throw new i(`Invalid token specified: invalid base64 for part #${a+1} (${n.message})`)}try{return JSON.parse(l)}catch(n){throw new i(`Invalid token specified: invalid json for part #${a+1} (${n.message})`)}}const J=()=>{const r=j(),[t,a]=x.useState(!1),s=O();$();const[l,n]=x.useState({}),N=async c=>{var h,f;c.preventDefault(),localStorage.clear(),a(!0);const d=new FormData(c.currentTarget),u=d.get("email"),k=d.get("password");try{const o=await T.post(`${_}/login`,{email:u,password:k});r({auth:{token:o.data.data.token,type:"Bearer"},userState:v(o.data.data.token)});const{role:g}=v(o.data.data.token);g=="user"?s("/home"):g=="organization"&&s("/admin-org/dashboard"),w.success(o.data.message,{position:"top-center",className:"bg-white",progressClassName:"bg-green-500",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1})}catch(o){console.error(o),w.error((f=(h=o.response)==null?void 0:h.data)==null?void 0:f.message,{position:"top-center",className:"bg-white",progressClassName:"bg-red-500",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1})}finally{a(!1)}},p=c=>{const{name:d,value:u}=c.target;n({...l,[d]:u})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen my-10 flex flex-col gap-5 items-center justify-center text-gray90",children:e.jsxs("form",{onSubmit:N,className:"md:w-[624px] px-5 md:px-0 text-justify",children:[e.jsx("h1",{className:"font-bold text-[24px] md:text-[32px]",children:"Welcome Back!"}),e.jsx("p",{className:"text-[12px] mt-2.5 md:text-base text-gray60 font-medium",children:"Start your journey to discover and join various exciting events within your favorite organizations with Sky Up."}),e.jsxs("div",{className:"mt-8 flex flex-col gap-7",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"email",className:"font-medium text-sm",children:"Email"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(L,{size:22,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",id:"email",name:"email",onChange:p,required:!0,placeholder:"youremail@example.com",className:"pl-10 p-3 border shadow bg-white rounded-lg w-full outline-none focus:border-primary"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"password",className:"font-medium text-sm",children:"Password"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(D,{size:22,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"password",id:"password",name:"password",onChange:p,required:!0,placeholder:"Type your password",className:"pl-10 p-3 border shadow bg-white rounded-lg w-full outline-none focus:border-primary"})]})]})]}),e.jsx("button",{type:"submit",disabled:t,className:`${t?"bg-gray-500 cursor-not-allowed":"bg-primary hover:bg-opacity-90"} p-3 font-semibold text-white rounded-lg text-center w-full mt-10`,children:t?"Loading...":"Login"}),e.jsxs("button",{className:"bg-[#E3EDF8] hover:bg-opacity-90 p-3 font-medium text-gray60 rounded-lg w-full mt-6 flex gap-2.5 justify-center items-center",children:[e.jsx("img",{src:"/images/icon/google.svg",alt:"",className:"w-7"})," Login with Google"]}),e.jsxs("p",{className:"text-center text-gray60 mt-10",children:["Don't have an account?"," ",e.jsx(E,{to:"/register",className:"text-primary hover:opacity-90",children:"Register"})]})]})}),e.jsx(A,{position:"top-center",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})};export{J as default};
